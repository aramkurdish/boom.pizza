<!DOCTYPE html>
<html lang="ku" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Print Orders - Boom Pizza</title>
    <link href="https://fonts.googleapis.com/css2?family=Vazirmatn:wght@400;700;900&display=swap" rel="stylesheet">
    <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-database-compat.js"></script>
    <style>
        :root { --accent: #ff3131; --bg: #0a0b0d; --card: #16181d; }
        body { font-family: 'Vazirmatn', sans-serif; background: var(--bg); color: white; margin: 0; padding: 15px; }
        .header { text-align: center; padding: 10px; border-bottom: 2px solid var(--accent); margin-bottom: 20px; }
        .order-card { background: var(--card); border-radius: 15px; padding: 20px; margin-bottom: 20px; border: 1px solid #25282e; }
        .id-badge { color: #ffc107; font-weight: 900; font-size: 1.2rem; }
        .items-box { background: #1f2229; padding: 15px; border-radius: 10px; margin: 15px 0; border: 1px solid #333; }
        .btn-print { background: #ffffff; color: #000; padding: 10px 20px; border-radius: 10px; border: none; font-weight: bold; cursor: pointer; }
        
        /* Ø´ÛÙˆØ§Ø²ÛŒ ÙˆÛ•Ø³ÚµÛ•Ú©Û• Ú©Ø§ØªÛŒ Ú†Ø§Ù¾Ú©Ø±Ø¯Ù† */
        #print-area { display: none; }
        @media print {
            body * { visibility: hidden; }
            #print-area, #print-area * { visibility: visible; }
            #print-area {
                display: block !important;
                position: absolute;
                left: 0; top: 0; width: 100%;
                color: black !important;
                background: white !important;
                padding: 10px;
                font-size: 14px;
            }
            .receipt-title { text-align: center; font-size: 22px; font-weight: 900; margin-bottom: 5px; }
            .receipt-id { text-align: center; font-size: 18px; border: 2px solid black; padding: 5px; margin: 10px 0; }
            .line { border-bottom: 1px dashed black; margin: 10px 0; }
        }
    </style>
</head>
<body>

    <div class="header"><h1>ğŸ• Ø¨Û•Ú•ÛÙˆØ¨Û•Ø±Ø§ÛŒÛ•ØªÛŒ Ø¯Ø§ÙˆØ§Ú©Ø§Ø±ÛŒÛŒÛ•Ú©Ø§Ù†</h1></div>
    <div id="list">Ú†Ø§ÙˆÛ•Ú•ÙˆØ§Ù† Ø¨Û•...</div>

    <div id="print-area"></div>

    <script>
        const firebaseConfig = {
            apiKey: "AIzaSyDqoOjm4m1Fxp760mJPy0sv5_NjaJfkm7g",
            authDomain: "boompizza-5d048.firebaseapp.com",
            databaseURL: "https://boompizza-5d048-default-rtdb.firebaseio.com",
            projectId: "boompizza-5d048",
            storageBucket: "boompizza-5d048.firebasestorage.app",
            messagingSenderId: "636068289590",
            appId: "1:636068289590:web:41fe758906140c700ecc97"
        };
        firebase.initializeApp(firebaseConfig);
        const db = firebase.database();

        // ÙÛ•Ù†Ú©Ø´Ù†ÛŒ Ú†Ø§Ù¾Ú©Ø±Ø¯Ù†ÛŒ ØªÛ•Ù†Ù‡Ø§ ÛŒÛ•Ú© Ø¯Ø§Ù†Û•
        function doPrint(id, items, total, phone, time, note) {
            const printArea = document.getElementById('print-area');
            printArea.innerHTML = `
                <div class="receipt-title">BOOM PIZZA</div>
                <div style="text-align:center">Ø¨Û•Ø®ÛØ±Ø¨ÛÛŒØª Ø¨Û† Ø¨ÙˆÙ… Ù¾ÛŒØªØ²Ø§</div>
                <div class="receipt-id">Ú˜Ù…Ø§Ø±Û•ÛŒ Ø¯Ø§ÙˆØ§Ú©Ø§Ø±ÛŒ: #${id}</div>
                <div class="line"></div>
                <div><b>Ú©Ø§Øª:</b> ${time}</div>
                <div><b>Ù…Û†Ø¨Ø§ÛŒÙ„:</b> ${phone}</div>
                <div class="line"></div>
                <div style="min-height: 50px;"><b>Ø¯Ø§ÙˆØ§Ú©Ø§Ø±ÛŒ:</b><br> ${items}</div>
                <div class="line"></div>
                ${note !== 'Ù†ÛŒÛŒÛ•' ? `<div><b>ØªÛØ¨ÛŒÙ†ÛŒ:</b> ${note}</div><div class="line"></div>` : ''}
                <div style="font-size: 18px; font-weight: bold; text-align: left;">Ú©Û†ÛŒ Ú¯Ø´ØªÛŒ: ${total} Ø¯ÛŒÙ†Ø§Ø±</div>
                <div class="line" style="border-bottom-style: solid;"></div>
                <div style="text-align:center; font-size: 10px; margin-top: 10px;">Ø³ÙˆÙ¾Ø§Ø³ Ø¨Û† Ù‡Û•ÚµØ¨Ú˜Ø§Ø±Ø¯Ù†ÛŒ Ø¦ÛÙ…Û•</div>
            `;
            window.print();
        }

        db.ref('orders').on('value', (snapshot) => {
            const listDiv = document.getElementById('list');
            const data = snapshot.val();
            listDiv.innerHTML = '';

            if (data) {
                Object.keys(data).reverse().forEach(key => {
                    const o = data[key];
                    const itemsStr = Array.isArray(o.items) ? o.items.join(' + ') : o.items;
                    listDiv.innerHTML += `
                        <div class="order-card">
                            <div style="display:flex; justify-content:space-between">
                                <span class="id-badge">#${o.id}</span>
                                <small style="color:#888">${o.time || ''}</small>
                            </div>
                            <div class="items-box"><b>Ø®ÙˆØ§Ø±Ø¯Ù†Û•Ú©Ø§Ù†:</b><br> ${itemsStr}</div>
                            <div style="margin-bottom:15px">ğŸ’° Ú©Û†: <b>${o.total}</b> | ğŸ“± ${o.phone}</div>
                            <button class="btn-print" onclick="doPrint('${o.id}', '${itemsStr}', '${o.total}', '${o.phone}', '${o.time}', '${o.note}')">Ú†Ø§Ù¾Ú©Ø±Ø¯Ù†ÛŒ Ø¦Û•Ù… ÙˆÛ•Ø³ÚµÛ• ğŸ–¨ï¸</button>
                        </div>
                    `;
                });
            }
        });
    </script>
</body>
</html>
