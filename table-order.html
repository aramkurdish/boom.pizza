<!DOCTYPE html>
<html lang="ku" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ø¨ÙˆÙ… Ù¾ÛŒØªØ²Ø§ - Ø³ÛŒØ³ØªÙ… Ù†Ø§ÙˆÛ•ÙˆÛ•</title>
    <link href="https://fonts.googleapis.com/css2?family=Vazirmatn:wght@400;700;900&display=swap" rel="stylesheet">
    <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-database-compat.js"></script>
    <style>
        :root { --accent: #ff3131; --bg: #0a0b0d; --card: #16181d; --text: #ffffff; --gold: #ffc107; }
        body { font-family: 'Vazirmatn', sans-serif; background-color: var(--bg); color: var(--text); margin: 0; padding-bottom: 50px; }
        
        .container { padding: 15px; max-width: 500px; margin: auto; }
        
        /* Table Grid */
        .table-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px; margin-bottom: 20px; }
        .table-btn { background: var(--card); border: 1px solid #25282e; color: white; padding: 15px 5px; border-radius: 12px; cursor: pointer; transition: 0.3s; font-family: inherit; }
        .table-btn.active { background: var(--accent); border-color: #fff; }

        /* Order Form */
        .order-form { background: var(--card); padding: 20px; border-radius: 20px; border: 1px solid #25282e; }
        
        /* Selected Items List */
        .selected-list { margin-top: 10px; border-top: 1px solid #333; padding-top: 10px; max-height: 200px; overflow-y: auto; }
        .item-row { display: flex; justify-content: space-between; align-items: center; background: #1f2229; padding: 10px; margin-bottom: 8px; border-radius: 10px; border-right: 3px solid var(--accent); }
        .del-btn { color: #ff3131; background: none; border: none; font-size: 1.2rem; cursor: pointer; }

        /* Category/Folder Styles */
        .category-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-bottom: 15px; }
        .cat-btn { background: #25282e; border: 1px solid #444; color: white; padding: 20px 10px; border-radius: 15px; cursor: pointer; text-align: center; font-weight: bold; }
        .cat-btn:active { background: var(--accent); }

        /* Modal Styles */
        .modal { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.9); z-index: 1000; justify-content: center; align-items: center; }
        .modal-content { background: var(--card); width: 85%; max-width: 350px; padding: 20px; border-radius: 20px; border: 1px solid var(--accent); }
        
        .food-item { background: #1f2229; padding: 15px; margin: 8px 0; border-radius: 12px; cursor: pointer; display: flex; justify-content: space-between; border: 1px solid #333; }
        
        .qty-input { width: 70px; text-align: center; font-size: 1.5rem; background: #000; color: var(--gold); border: 1px solid #444; border-radius: 8px; padding: 5px; }
        .extra-input { width: 100%; padding: 12px; background: #1f2229; border: 1px solid #333; color: white; border-radius: 10px; margin-top: 10px; font-family: inherit; }

        .btn-main { background: var(--accent); color: white; padding: 15px; border-radius: 12px; border: none; width: 100%; font-weight: bold; cursor: pointer; margin-top: 10px; font-family: inherit; }
        .btn-cancel { background: #333; color: #fff; padding: 10px; border-radius: 8px; border: none; width: 100%; margin-top: 10px; cursor: pointer; font-family: inherit; }
    </style>
</head>
<body>

    <div class="container">
        <h2 style="text-align:center; color:var(--accent);">Ø¨ÙˆÙ… Ù¾ÛŒØªØ²Ø§ ğŸ•</h2>
        
        <div class="table-grid">
            <button class="table-btn" onclick="selectDesk(1, this)">Ù…ÛØ²ÛŒ Ù¡</button>
            <button class="table-btn" onclick="selectDesk(2, this)">Ù…ÛØ²ÛŒ Ù¢</button>
            <button class="table-btn" onclick="selectDesk(3, this)">Ù…ÛØ²ÛŒ Ù£</button>
            <button class="table-btn" onclick="selectDesk(4, this)">Ù…ÛØ²ÛŒ Ù¤</button>
            <button class="table-btn" onclick="selectDesk(5, this)">Ù…ÛØ²ÛŒ Ù¥</button>
            <button class="table-btn" onclick="selectDesk(6, this)">Ù…ÛØ²ÛŒ Ù¦</button>
        </div>

        <div class="order-form">
            <p style="margin: 0 0 10px; font-size: 0.9rem; color: #888;">Ù¾Û†Ù„ÛÙ†Û•Ú©Ø§Ù† Ù‡Û•ÚµØ¨Ú˜ÛØ±Û•:</p>
            
            <div class="category-grid">
                <div class="cat-btn" onclick="openCat('Ù¾ÛŒØªØ²Ø§Ú©Ø§Ù†')">ğŸ• Ù¾ÛŒØªØ²Ø§Ú©Ø§Ù†</div>
                <div class="cat-btn" onclick="openCat('Ø¨Û•Ø±Ú¯Ø±Û•Ú©Ø§Ù†')">ğŸ” Ø¨Û•Ø±Ú¯Ø±Û•Ú©Ø§Ù†</div>
                <div class="cat-btn" onclick="openCat('Ù„Ø§ÙˆÛ•Ú©ÛŒÛŒÛ•Ú©Ø§Ù†')">ğŸŸ Ù„Ø§ÙˆÛ•Ú©ÛŒÛŒÛ•Ú©Ø§Ù†</div>
                <div class="cat-btn" onclick="openCat('Ø®ÙˆØ§Ø±Ø¯Ù†Û•ÙˆÛ•')">ğŸ¥¤ Ø®ÙˆØ§Ø±Ø¯Ù†Û•ÙˆÛ•</div>
            </div>
            
            <div class="selected-list" id="selected-list">
                </div>

            <div style="margin-top:20px; border-top:1px solid #333; padding-top:15px;">
                <div style="display:flex; justify-content:space-between; font-weight:bold;">
                    <span>Ú©Û†ÛŒ Ú¯Ø´ØªÛŒ:</span>
                    <span id="display-total" style="color:var(--gold);">0 Ø¯.Ø¹</span>
                </div>
                <button class="btn-main" onclick="sendOrder()">Ù†Ø§Ø±Ø¯Ù†ÛŒ Ø¯Ø§ÙˆØ§Ú©Ø§Ø±ÛŒ Ø¨Û† Ø¦Û•Ø¯Ù…ÛŒÙ† âœ…</button>
            </div>
        </div>
    </div>

    <div id="cat-modal" class="modal">
        <div class="modal-content">
            <h3 id="cat-title" style="margin-top:0; color:var(--accent);">Ù†Ø§Ùˆ</h3>
            <div id="food-list" style="max-height: 350px; overflow-y: auto;">
                </div>
            <button class="btn-cancel" onclick="closeModal('cat-modal')">Ø¯Ø§Ø®Ø³ØªÙ†</button>
        </div>
    </div>

    <div id="qty-modal" class="modal">
        <div class="modal-content" style="text-align:center;">
            <h3 id="modal-food-name" style="margin-top:0;">Ù†Ø§Ùˆ</h3>
            <div style="margin:15px 0;">
                <label style="display:block; margin-bottom:10px; color:#888;">Ø¨Ú•ÛŒ Ø¯Ø§ÙˆØ§Ú©Ø±Ø§Ùˆ:</label>
                <input type="number" id="qty-input" class="qty-input" value="1" onfocus="this.select()">
            </div>
            <input type="text" id="extra-input" class="extra-input" placeholder="Ø²ÛŒØ§Ø¯Û•ÛŒÛ•Ú© (ÙˆÛ•Ú©: Ø¨Û Ù¾ÛŒØ§Ø²ØŒ Ù¾Û•Ù†ÛŒØ±...)">
            <button class="btn-main" onclick="confirmAdd()">Ù¾Ø§Ø´Û•Ú©Û•ÙˆØª Ùˆ Ø²ÛŒØ§Ø¯Ú©Ø±Ø¯Ù†</button>
            <button class="btn-cancel" onclick="closeModal('qty-modal')">Ù¾Ø§Ø´Ú¯Û•Ø²Ø¨ÙˆÙˆÙ†Û•ÙˆÛ•</button>
        </div>
    </div>

    <script>
        const firebaseConfig = {
            apiKey: "AIzaSyDqoOjm4m1Fxp760mJPy0sv5_NjaJfkm7g",
            databaseURL: "https://boompizza-5d048-default-rtdb.firebaseio.com",
            projectId: "boompizza-5d048",
        };
        firebase.initializeApp(firebaseConfig);
        const db = firebase.database();

        const menuData = {
            'Ù¾ÛŒØªØ²Ø§Ú©Ø§Ù†': [
                { name: 'Ù¾ÛŒØªØ²Ø§ Ù…ÛÚ©Ø³', price: 8000 },
                { name: 'Ù¾ÛŒØªØ²Ø§ Ù¾ÛŒØ±Û†Ù†ÛŒ', price: 7000 },
                { name: 'Ù¾ÛŒØªØ²Ø§ Ù…Ø±ÛŒØ´Ú©', price: 7500 },
                { name: 'Ù¾ÛŒØªØ²Ø§ Ø³Û•ÙˆØ²Û•', price: 6000 }
            ],
            'Ø¨Û•Ø±Ú¯Ø±Û•Ú©Ø§Ù†': [
                { name: 'Ø¨Û•Ø±Ú¯Ø± Ú¯Û†Ø´Øª', price: 5000 },
                { name: 'Ø¨Û•Ø±Ú¯Ø± Ù…Ø±ÛŒØ´Ú©', price: 4500 },
                { name: 'Ø²ÛŒÙ†Ú¯Û•Ø± Ø¨Û•Ø±Ú¯Ø±', price: 5500 }
            ],
            'Ù„Ø§ÙˆÛ•Ú©ÛŒÛŒÛ•Ú©Ø§Ù†': [
                { name: 'ÙÛŒÙ†Ú¯Û•Ø±', price: 2500 },
                { name: 'Ù†Ø§Ú¯ÛØª', price: 3500 },
                { name: 'Ù¾Û•ØªØ§ØªÛ•ÛŒ Ø³ÙˆÙˆØ±Û•Ú©Ø±Ø§Ùˆ', price: 2000 }
            ],
            'Ø®ÙˆØ§Ø±Ø¯Ù†Û•ÙˆÛ•': [
                { name: 'Ù¾ÛÙ¾Ø³ÛŒ', price: 500 },
                { name: 'Ø¦Ø§Ùˆ', price: 250 },
                { name: 'Ø´Û•Ø±Ø¨Û•Øª', price: 1000 }
            ]
        };

        let selectedDesk = null;
        let cart = [];
        let currentItem = null;

        function selectDesk(num, btn) {
            selectedDesk = num;
            document.querySelectorAll('.table-btn').forEach(b => b.classList.remove('active'));
            btn.classList.add('active');
        }

        function openCat(catName) {
            const list = document.getElementById('food-list');
            document.getElementById('cat-title').innerText = catName;
            list.innerHTML = '';
            
            menuData[catName].forEach(food => {
                list.innerHTML += `
                    <div class="food-item" onclick="openQty('${food.name}', ${food.price})">
                        <span>${food.name}</span>
                        <span style="color:var(--gold)">${food.price.toLocaleString()}</span>
                    </div>
                `;
            });
            document.getElementById('cat-modal').style.display = 'flex';
        }

        function openQty(name, price) {
            currentItem = { name, price };
            document.getElementById('modal-food-name').innerText = name;
            document.getElementById('qty-input').value = 1;
            document.getElementById('extra-input').value = "";
            document.getElementById('qty-modal').style.display = 'flex';
        }

        function confirmAdd() {
            const qty = parseInt(document.getElementById('qty-input').value) || 1;
            const extra = document.getElementById('extra-input').value;
            
            cart.push({
                name: currentItem.name,
                price: currentItem.price,
                qty: qty,
                extra: extra,
                total: currentItem.price * qty
            });
            
            closeModal('qty-modal');
            closeModal('cat-modal');
            updateCartUI();
        }

        function updateCartUI() {
            const list = document.getElementById('selected-list');
            const totalEl = document.getElementById('display-total');
            list.innerHTML = '';
            let total = 0;

            cart.forEach((item, index) => {
                total += item.total;
                list.innerHTML += `
                    <div class="item-row">
                        <div>
                            <b>${item.qty}x ${item.name}</b>
                            ${item.extra ? `<small style="display:block; color:#888;">+ ${item.extra}</small>` : ''}
                        </div>
                        <div style="display:flex; align-items:center; gap:10px;">
                            <span>${item.total.toLocaleString()}</span>
                            <button class="del-btn" onclick="removeItem(${index})">Ã—</button>
                        </div>
                    </div>
                `;
            });
            totalEl.innerText = total.toLocaleString() + " Ø¯.Ø¹";
        }

        function removeItem(index) {
            cart.splice(index, 1);
            updateCartUI();
        }

        function closeModal(id) { document.getElementById(id).style.display = 'none'; }

        function sendOrder() {
            if (!selectedDesk) return alert("ØªÚ©Ø§ÛŒÛ• Ù…ÛØ²ÛÚ© Ù‡Û•ÚµØ¨Ú˜ÛØ±Û•!");
            if (cart.length === 0) return alert("Ù‡ÛŒÚ† Ø®ÙˆØ§Ø±Ø¯Ù†ÛÚ© Ù‡Û•ÚµÙ†Û•Ø¨Ú˜ÛØ±Ø¯Ø±Ø§ÙˆÛ•!");

            const itemsSummary = cart.map(i => `${i.qty}x ${i.name}${i.extra ? ' ('+i.extra+')' : ''}`).join(' + ');
            const finalTotal = cart.reduce((s, i) => s + i.total, 0);

            const orderData = {
                id: Math.floor(1000 + Math.random() * 9000),
                items: itemsSummary,
                total: finalTotal.toLocaleString() + " Ø¯.Ø¹",
                phone: "Ù†Ø§ÙˆÛ•ÙˆÛ• (Ù…ÛØ²ÛŒ " + selectedDesk + ")",
                time: new Date().toLocaleString('en-CA', { hour12: false }).replace(',', '')
            };

            db.ref('orders').push(orderData).then(() => {
                alert("Ø¯Ø§ÙˆØ§Ú©Ø§Ø±ÛŒÛŒÛ•Ú©Û• Ø¨Û• Ø³Û•Ø±Ú©Û•ÙˆØªÙˆÙˆÛŒÛŒ Ù†ÛØ±Ø¯Ø±Ø§!");
                location.reload();
            });
        }
    </script>
</body>
</html>
